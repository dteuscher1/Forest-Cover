---
title: "ForestCover"
author: "Matthew Morgan & David Teuscher"
date: "6/5/2020"
output: pdf_document
---

```{r, message = FALSE}
library(caret)
library(tidyverse)
library(DataExplorer)
library(beepr)
```

```{r}
train <- read.csv("train.csv")
test <- read.csv("test.csv")
```

```{r}
# Histogram to show how many of each forest cover
ggplot(train, aes(x = as.factor(Cover_Type))) + geom_bar(fill = "navyblue") + labs(x = "Cover Type", y = "Frequency")

# The number of patches for each type of forest cover is approximately equal for all types of forest cover
```


```{r}
myControl <- trainControl(method = "repeatedcv",
                          number = 10)

tunegrid <- expand.grid(eta = .25,
                        max_depth = 3,
                        colsample_bytree = .9,
                        subsample = .8,
                        nrounds = 100,
                        min_child_weight = 1,
                        gamma = .075)
xgbTree.model <- train(as.factor(Cover_Type)~.-Id,
                   data = train,
                   method = "xgbTree",
                   tuneGrid = tunegrid,
                   trControl = myControl,
                   metric = "Accuracy",
                   preProc = c("nzv","zv", "center", "scale")
)
xgbTree.model
beep(sound = 8)
preds <- predict(xgbTree.model, test)
xgbTree <- data.frame(Id = test$Id, Cover_Type = preds)
write_csv(xgbTree, "xgbTree-preds.csv")
```

```{r}

grid <- expand.grid("n.trees" = 500, "interaction.depth" = 4, "shrinkage" = 0.1, "n.minobsinnode" = 20)
rfb.mod <- train(as.factor(Cover_Type)~.-Id,
                 data = train,
                 method = "gbm",
                 tuneGrid = grid,
                 trControl = myControl,
                 metric = "Accuracy",
                 verbose = FALSE,
                 preProcess = c("nzv", "zv", "center", "scale")
                 )
beep(sound = 8)
preds <- predict(rfb.mod, test)
gbm <- data.frame(Id = test$Id, Cover_Type = preds)
write_csv(gbm, "gbm-preds.csv")
```

```{r}
svmLinear.model <- train(as.factor(Cover_Type) ~ . -Id,
                         data = train,
                         method = "svmLinear",
                         tuneLength = 4,
                         trControl = myControl,
                         metric = "Accuracy",
                         #verbose = FALSE,
                         preProcess = c("zv", "center", "scale")
                         )
svmLinear.model
beep(sound = 2)
```


```{r}

grid <- expand.grid("mtry" = c(50, 52), splitrule = "extratrees", min.node.size = 1)
rf.model <- train(as.factor(Cover_Type) ~ . -Id,
                  data = train, 
                  method = "ranger",
                  trControl = myControl,
                  tuneGrid = grid,
                  metric = "Accuracy",
                  preProcess = c("zv", "center", "scale"))
rf.model

beep(sound = 8)

preds <- predict(rf.model, test)
rf <- data.frame(Id = test$Id, Cover_Type = preds)
write_csv(rf, "rf-preds.csv")

```

